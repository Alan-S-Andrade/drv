set(GNU_RISCV_TOOLCHAIN_PREFIX @GNU_RISCV_TOOLCHAIN_PREFIX@)
set(SST_CORE_PREFIX @SST_CORE_PREFIX@)
set(SST_ELEMENTS_PREFIX @SST_ELEMENTS_PREFIX@)
set(DRV_INSTALL_PREFIX @CMAKE_INSTALL_PREFIX@)
set(DRV_SOURCE_DIR @DRV_SOURCE_DIR@)
set(DRV_BINARY_DIR @DRV_BINARY_DIR@)
set(SST_DIR @SST_CORE_PREFIX@/lib/cmake/SST)

if (NOT DEFINED ARCH_RV64)
  find_package(Boost REQUIRED)
  find_package(SST REQUIRED)
  if (NOT TARGET drvapi)
    message(STATUS "Adding drvapi target")
    add_library(drvapi SHARED IMPORTED GLOBAL)
    set_target_properties(drvapi PROPERTIES
      INTERFACE_INCLUDE_DIRECTORIES @CMAKE_INSTALL_PREFIX@/include
      IMPORTED_LOCATION @CMAKE_INSTALL_PREFIX@/lib/libdrvapi.so
      INTERFACE_LINK_LIBRARIES Boost::boost
      INTERFACE_COMPILE_OPTIONS @CXX_STD@
      )
  endif()
  if (NOT TARGET Drv)
    message(STATUS "Adding Drv target")
    add_library(Drv SHARED IMPORTED GLOBAL)
    set_target_properties(Drv PROPERTIES
      INTERFACE_INCLUDE_DIRECTORIES @CMAKE_INSTALL_PREFIX@/include
      IMPORTED_LOCATION @CMAKE_INSTALL_PREFIX@/lib/libDrv.so
      INTERFACE_LINK_LIBRARIES "drvapi SST::SSTCore"
      )
  endif()
  if (NOT TARGET pandocommand)
    message(STATUS "Adding pandocommand target")
    add_library(pandocommand SHARED IMPORTED GLOBAL)
    set_target_properties(pandocommand PROPERTIES
      INTERFACE_INCLUDE_DIRECTORIES @CMAKE_INSTALL_PREFIX@/include
      IMPORTED_LOCATION @CMAKE_INSTALL_PREFIX@/lib/libpandocommand.so
      INTERFACE_LINK_LIBRARIES drvapi
      )
  endif()
  if (NOT TARGET pandocommand_loader)
    message(STATUS "Adding pandocommand_loader target")
    add_library(pandocommand_loader SHARED IMPORTED GLOBAL)
    set_target_properties(pandocommand_loader PROPERTIES
      INTERFACE_INCLUDE_DIRECTORIES @CMAKE_INSTALL_PREFIX@/include
      IMPORTED_LOCATION @CMAKE_INSTALL_PREFIX@/lib/libpandocommand_loader.so
      INTERFACE_LINK_LIBRARIES pandocommand
      )
  endif()
else()
  if (NOT TARGET pandohammer)
    message("Adding pandohammer target")
    file(GLOB_RECURSE PANDOHAMMER_C_SOURCES ${DRV_INSTALL_PREFIX}/rv64/lib/*.c)
    file(GLOB_RECURSE PANDOHAMMER_ASM_SOURCES ${DRV_INSTALL_PREFIX}/rv64/lib/*.S)
    add_library(pandohammer OBJECT ${DRV_INSTALL_PREFIX} ${PANDOHAMMER_C_SOURCES} ${PANDOHAMMER_ASM_SOURCES})
    #set_property(TARGET pandohammer PROPERTY IMPORTED_LOCATION ${DRV_INSTALL_PREFIX}/pandohammer/lib/libpandohammer.a)
    target_include_directories(pandohammer PUBLIC ${DRV_INSTALL_PREFIX}/rv64/include)
    #set_property(TARGET pandohammer PROPERTY INTERFACE_INCLUDE_DIRECTORIES ${DRV_INSTALL_PREFIX}/rv64/include)
    target_link_options(pandohammer PUBLIC -nostartfiles -T ${DRV_INSTALL_PREFIX}/rv64/lib/bsg_link.ld)
    #set_property(TARGET pandohammer PROPERTY INTERFACE_LINK_OPTIONS -T ${DRV_INSTALL_PREFIX}/rv64/lib/bsg_link.ld)
    #set_property(TARGET pandohammer PROPERTY INTERFACE_COMPILE_OPTIONS -nostartfiles)
    target_compile_options(pandohammer PUBLIC -nostartfiles)
  endif()
endif()

include(DRVInclude)
